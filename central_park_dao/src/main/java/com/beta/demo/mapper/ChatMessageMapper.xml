<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.beta.demo.dao.ChatMessageDao">

    <resultMap id="full_fields_map" type="ChatMessage">
        <id property="id" column="id"/>
        <result property="sentTime" column="sent_time"/>
        <result property="messageType" column="message_type"/>
        <result property="messagePayload" column="message_payload"/>
        <result property="messageRef" column="message_ref"/>

        <association property="user" javaType="User">
            <id property="id" column="user_id"/>
            <result property="username" column="username"/>
            <result property="password" column="password"/>
            <result property="portrait" column="portrait"/>
            <result property="registerDate" column="register_date"/>
            <result property="gender" column="gender"/>
            <result property="email" column="email"/>
        </association>
    </resultMap>


    <select id="selectAll" resultMap="full_fields_map">
        select id,
               sent_time,
               message_type,
               message_payload,
               message_ref,
               user_id,
               username,
               password,
               portrait,
               register_date,
               gender,
               email
        from t_chat_message
                 left join t_user on t_chat_message.user_id = t_user.id
    </select>


    <insert id="insert" parameterType="ChatMessage">
        insert into t_chat_message (id, user_id, sent_time, message_type, message_payload, message_ref)
        VALUES (#{id}, #{user.id}, #{sentTime}, #{messageType}, #{messagePayload}, #{messageRef})
    </insert>

</mapper>
